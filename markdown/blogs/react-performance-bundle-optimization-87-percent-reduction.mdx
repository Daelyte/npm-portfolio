---
title: "From 960KB to 120KB: Optimizing React Bundle Size by 87%"
published_at: "2025-01-10"
description: "Real performance optimization on a production React app. How I reduced icon bundle size by 87.5%, improved Lighthouse scores from 48 to 93, and cut load times by 1.4 seconds."
slug: "react-performance-bundle-optimization-87-percent-reduction"
---

# From 960KB to 120KB: Optimizing React Bundle Size by 87%

**Project**: Frame Economics - 200-350 daily active users  
**Initial Lighthouse Performance**: 48/100 ðŸ”´  
**Final Lighthouse Performance**: 93/100 âœ…  
**Time Investment**: One focused afternoon

## The Wake-Up Call

Users started complaining about slow initial load times. Lighthouse confirmed it - Performance score of 48. Unacceptable for a modern React app.

First step: **Bundle analysis**.

```bash
npm run build:analyze
```

The visualizer opened. One thing stood out immediately - a massive purple block labeled "lucide-react": **960KB**.

## The Icon Problem

Frame Economics uses Lucide React for icons throughout the UI. The problem? We were importing the entire library:

```typescript
// âŒ The problem
import { Heart, MessageCircle, Share, Settings, User, Bell, /* ...50 more */ } from 'lucide-react';
```

**What actually shipped**: Every single icon in the Lucide library. All 1,000+ icons. 960KB of unused SVG code.

## Solution #1: Tree-Shakeable Imports

Lucide React supports tree-shaking, but you need to configure it correctly.

### Vite Configuration Update

```javascript
// vite.config.js
export default defineConfig({
  optimizeDeps: {
    include: ['react', 'react-dom', 'lucide-react']
  },
  build: {
    rollupOptions: {
      output: {
        manualChunks(id) {
          // Separate icons into their own chunk
          if (id.includes('lucide-react') || id.includes('/icons/')) {
            return 'icons';
          }
        },
      },
    },
  },
});
```

### Import Pattern Change

Created a centralized icon module:

```typescript
// src/components/icons/index.ts
export {
  Heart,
  MessageCircle,
  Share2 as Share,
  Settings,
  User,
  Bell,
  BookOpen,
  TrendingUp,
  // Only the icons we actually use
} from 'lucide-react';
```

Then updated all components:

```typescript
// âŒ Before
import { Heart } from 'lucide-react';

// âœ… After  
import { Heart } from '@/components/icons';
```

**Result**: Bundle analyzer showed icons chunk dropped from 960KB â†’ **420KB**. Good, but not good enough.

## Solution #2: Dynamic Icon Loading

For icons used in less-critical paths (dashboards, settings), implemented dynamic imports:

```typescript
// src/components/icons/DynamicIcon.tsx
import { lazy, Suspense } from 'react';
import type { LucideProps } from 'lucide-react';

const iconCache = new Map();

export function DynamicIcon({ name, ...props }: { name: string } & LucideProps) {
  if (!iconCache.has(name)) {
    iconCache.set(
      name,
      lazy(() => 
        import('lucide-react').then(mod => ({ 
          default: mod[name] 
        }))
      )
    );
  }
  
  const Icon = iconCache.get(name);
  
  return (
    <Suspense fallback={<div className="w-6 h-6" />}>
      <Icon {...props} />
    </Suspense>
  );
}
```

Usage:

```typescript
// For dashboard/settings (not critical path)
<DynamicIcon name="TrendingUp" className="w-6 h-6" />

// For buttons/nav (critical path)
import { Heart } from '@/components/icons';
<Heart className="w-5 h-5" />
```

**Result**: Icons chunk down to **280KB**.

## Solution #3: SVG Sprite System

For the most-used icons (Heart, Comment, Share), created an SVG sprite:

```typescript
// public/icons-sprite.svg
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="icon-heart" viewBox="0 0 24 24">
    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
  </symbol>
  <symbol id="icon-comment" viewBox="0 0 24 24">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
  </symbol>
</svg>
```

Sprite icon component:

```typescript
// src/components/icons/SpriteIcon.tsx
export function SpriteIcon({ 
  name, 
  className 
}: { 
  name: string; 
  className?: string;
}) {
  return (
    <svg className={className}>
      <use href={`/icons-sprite.svg#icon-${name}`} />
    </svg>
  );
}
```

**Final icons bundle**: **120KB** (87.5% reduction from 960KB)

## Code Splitting Strategy

While optimizing icons, audited the entire bundle:

### Before: Single 1.4MB Bundle

```
vendor.js - 1.4MB (React, Framer Motion, Supabase, icons, everything)
```

### After: Chunked by Feature

```javascript
// vite.config.js
rollupOptions: {
  output: {
    manualChunks(id) {
      // React core (keep scheduler here to avoid split)
      if (id.includes('node_modules/react/') || 
          id.includes('node_modules/react-dom/') ||
          /node_modules[\\/]scheduler[\\/]/.test(id)) {
        return 'react-vendor';
      }
      
      // Animation libraries (lazy loaded)
      if (id.includes('framer-motion') || id.includes('react-spring')) {
        return 'animations';
      }
      
      // Icons
      if (id.includes('lucide-react') || id.includes('/icons/')) {
        return 'icons';
      }
      
      // Forms (only loaded on forms pages)
      if (id.includes('react-hook-form') || id.includes('zod')) {
        return 'forms';
      }
      
      // State management
      if (id.includes('zustand') || id.includes('@tanstack/react-query')) {
        return 'state';
      }
    },
  },
}
```

### Result: Smart Chunking

```
react-vendor.js - 180KB (loaded immediately)
icons.js - 120KB (loaded immediately)  
animations.js - 240KB (lazy loaded)
forms.js - 95KB (lazy loaded on /contact, /settings)
state.js - 85KB (loaded immediately)
app.js - 340KB (app code)
```

**Total initial load**: 640KB (down from 1.4MB)

## Route-Based Code Splitting

Implemented lazy loading for route components:

```typescript
// src/FrameEconomicsWebsite.tsx
import { lazy, Suspense } from 'react';

const StoryDashboard = lazy(() => import('./components/StoryDashboard'));
const UserSettings = lazy(() => import('./components/UserSettings'));
const AdvancedTheory = lazy(() => import('./components/AdvancedTheory'));

function App() {
  return (
    <Suspense fallback={<LoadingSpinner />}>
      <Routes>
        <Route path="/" element={<HomePage />} />
        <Route path="/dashboard" element={<StoryDashboard />} />
        <Route path="/settings" element={<UserSettings />} />
        <Route path="/advanced" element={<AdvancedTheory />} />
      </Routes>
    </Suspense>
  );
}
```

**Impact**: Initial bundle doesn't include dashboard/settings code. Loaded on-demand.

## CSS Optimization

Switched from regular CSS minification to Lightning CSS:

```javascript
// vite.config.js
export default defineConfig({
  build: {
    cssMinify: 'lightningcss', // Faster, smaller output than cssnano
  },
});
```

Tailwind CSS purging configuration:

```javascript
// tailwind.config.js
module.exports = {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  // Removed unused Tailwind utilities
  safelist: [], // Only what's actually used
};
```

**CSS bundle**: 85KB â†’ **42KB** (50% reduction)

## Image Optimization

Images were being served unoptimized. Added responsive images:

```typescript
// Before
<img src="/hero-image.png" alt="Hero" />

// After
<picture>
  <source 
    srcSet="/hero-image-small.webp" 
    media="(max-width: 640px)" 
    type="image/webp"
  />
  <source 
    srcSet="/hero-image.webp" 
    type="image/webp"
  />
  <img 
    src="/hero-image.jpg" 
    alt="Hero"
    loading="lazy"
    decoding="async"
  />
</picture>
```

Used Sharp for build-time optimization:

```javascript
// scripts/optimize-images.js
import sharp from 'sharp';

await sharp('public/hero-image.png')
  .resize(1920, null, { withoutEnlargement: true })
  .webp({ quality: 85 })
  .toFile('public/hero-image.webp');
  
await sharp('public/hero-image.png')
  .resize(640, null, { withoutEnlargement: true })
  .webp({ quality: 80 })
  .toFile('public/hero-image-small.webp');
```

## The Results

### Bundle Sizes

| Asset | Before | After | Reduction |
|-------|--------|-------|-----------|
| Icons | 960KB | 120KB | **87.5%** |
| CSS | 85KB | 42KB | **50.6%** |
| Total Initial | 1.4MB | 640KB | **54.3%** |
| Full App | 2.1MB | 1.18MB | **43.8%** |

### Lighthouse Scores

| Metric | Before | After | Change |
|--------|--------|-------|--------|
| Performance | 48 | 93 | **+45** |
| FCP | 2.8s | 1.1s | **-1.7s** |
| LCP | 4.2s | 1.8s | **-2.4s** |
| TBT | 420ms | 80ms | **-340ms** |
| CLS | 0.12 | 0.02 | **-0.10** |

### Real User Impact

- **Initial load time**: 4.2s â†’ 1.8s (**57% faster**)
- **Time to Interactive**: 5.1s â†’ 2.4s (**53% faster**)
- **Bounce rate**: 18% â†’ 9% (**50% reduction**)

## AI Collaboration Reality

This optimization was heavily AI-assisted:

**AI helped with:**
- Generating the SVG sprite system code
- Suggesting `manualChunks` configuration patterns
- Writing the Sharp optimization script
- Explaining Lightning CSS benefits

**Human decisions:**
- Which icons to put in sprites vs dynamic loading
- Code splitting boundaries (what goes in which chunk)
- Testing performance on actual user devices
- Prioritizing which optimizations to implement first

The analysis and strategy came from experience. AI accelerated implementation.

## Tools Used

- **Vite Bundle Visualizer** - Visual bundle analysis
- **Lighthouse CI** - Automated performance testing
- **Chrome DevTools Performance** - Real profiling
- **WebPageTest** - Real-world performance testing
- **Sharp** - Image optimization

## Implementation Checklist

If you're facing similar issues:

1. âœ… Run `npm run build:analyze` - See what's actually in your bundle
2. âœ… Check icon library imports - Tree-shake or use sprites
3. âœ… Implement code splitting - Route-based at minimum
4. âœ… Optimize CSS - Lightning CSS + Tailwind purging
5. âœ… Add lazy loading - Images and non-critical components
6. âœ… Test on real devices - Not just DevTools throttling
7. âœ… Monitor production - Set up performance budgets

## Resources

- [Vite Performance Guide](https://vitejs.dev/guide/performance.html)
- [Lucide Tree-Shaking](https://lucide.dev/guide/installation#tree-shaking)
- [Web.dev Bundle Size](https://web.dev/reduce-javascript-payloads-with-code-splitting/)

---

**Stack**: React 18, TypeScript, Vite, Tailwind CSS, Vercel  
**Time**: One afternoon + ongoing monitoring  
**Impact**: Load time reduced by 57%, bounce rate cut in half
